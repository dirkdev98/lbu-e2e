/* eslint-disable no-unused-vars */

// Generated by @lbu/code-gen at 2020-04-21T19:22:26.229Z
/* eslint-disable no-unused-vars */

import { getBodyParser, compose, AppError } from "@lbu/server";
import {
  todoValidators,
  unimplementedValidators,
  lbuValidators,
} from "./validators.js";

let _internalBodyParser = undefined;
function parseBody(ctx) {
  if (_internalBodyParser === undefined) {
    const bp = getBodyParser();
    _internalBodyParser = (ctx) => new Promise((r) => bp(ctx, r).then(r));
  }

  return _internalBodyParser(ctx);
}

const filterCompose = (...args) =>
  compose(args.filter((it) => it !== undefined));

export const tagMiddleware = {
  _lbu: undefined,
};

export const groupMiddleware = {
  todo: undefined,

  unimplemented: undefined,

  lbu: undefined,
};

const _composed = {
  TodoAll: undefined,

  TodoOne: undefined,

  TodoNew: undefined,

  TodoCreateItem: undefined,

  TodoToggleItem: undefined,

  TodoDelete: undefined,

  UnimplementedGetUser: undefined,

  UnimplementedSettings: undefined,

  LbuStructure: undefined,
};

const handlers = {
  TodoAll: function (params, ctx, next) {
    ctx.request.params = params;

    if (_composed.TodoAll === undefined) {
      const currentHandler = todoHandlers.all;
      _composed.TodoAll = filterCompose(
        groupMiddleware.todo,
        ...(Array.isArray(currentHandler) ? currentHandler : [currentHandler])
      );
    }

    return _composed.TodoAll(ctx, next);
  },

  TodoOne: function (params, ctx, next) {
    ctx.request.params = params;

    ctx.validatedParams = todoValidators.nameParam(params);

    if (_composed.TodoOne === undefined) {
      const currentHandler = todoHandlers.one;
      _composed.TodoOne = filterCompose(
        groupMiddleware.todo,
        ...(Array.isArray(currentHandler) ? currentHandler : [currentHandler])
      );
    }

    return _composed.TodoOne(ctx, next);
  },

  TodoNew: async function (params, ctx, next) {
    ctx.request.params = params;

    await parseBody(ctx);

    ctx.validatedBody = todoValidators.newBody(ctx.request.body);

    if (_composed.TodoNew === undefined) {
      const currentHandler = todoHandlers.new;
      _composed.TodoNew = filterCompose(
        groupMiddleware.todo,
        ...(Array.isArray(currentHandler) ? currentHandler : [currentHandler])
      );
    }

    return _composed.TodoNew(ctx, next);
  },

  TodoCreateItem: async function (params, ctx, next) {
    ctx.request.params = params;

    ctx.validatedParams = todoValidators.nameParam(params);

    await parseBody(ctx);

    ctx.validatedBody = todoValidators.createItemBody(ctx.request.body);

    if (_composed.TodoCreateItem === undefined) {
      const currentHandler = todoHandlers.createItem;
      _composed.TodoCreateItem = filterCompose(
        groupMiddleware.todo,
        ...(Array.isArray(currentHandler) ? currentHandler : [currentHandler])
      );
    }

    return _composed.TodoCreateItem(ctx, next);
  },

  TodoToggleItem: async function (params, ctx, next) {
    ctx.request.params = params;

    ctx.validatedParams = todoValidators.nameParam(params);

    await parseBody(ctx);

    ctx.validatedBody = todoValidators.toggleItemBody(ctx.request.body);

    if (_composed.TodoToggleItem === undefined) {
      const currentHandler = todoHandlers.toggleItem;
      _composed.TodoToggleItem = filterCompose(
        groupMiddleware.todo,
        ...(Array.isArray(currentHandler) ? currentHandler : [currentHandler])
      );
    }

    return _composed.TodoToggleItem(ctx, next);
  },

  TodoDelete: function (params, ctx, next) {
    ctx.request.params = params;

    ctx.validatedParams = todoValidators.nameParam(params);

    if (_composed.TodoDelete === undefined) {
      const currentHandler = todoHandlers.delete;
      _composed.TodoDelete = filterCompose(
        groupMiddleware.todo,
        ...(Array.isArray(currentHandler) ? currentHandler : [currentHandler])
      );
    }

    return _composed.TodoDelete(ctx, next);
  },

  UnimplementedGetUser: function (params, ctx, next) {
    ctx.request.params = params;

    if (_composed.UnimplementedGetUser === undefined) {
      const currentHandler = unimplementedHandlers.getUser;
      _composed.UnimplementedGetUser = filterCompose(
        groupMiddleware.unimplemented,
        ...(Array.isArray(currentHandler) ? currentHandler : [currentHandler])
      );
    }

    return _composed.UnimplementedGetUser(ctx, next);
  },

  UnimplementedSettings: function (params, ctx, next) {
    ctx.request.params = params;

    if (_composed.UnimplementedSettings === undefined) {
      const currentHandler = unimplementedHandlers.settings;
      _composed.UnimplementedSettings = filterCompose(
        groupMiddleware.unimplemented,
        ...(Array.isArray(currentHandler) ? currentHandler : [currentHandler])
      );
    }

    return _composed.UnimplementedSettings(ctx, next);
  },

  LbuStructure: function (params, ctx, next) {
    ctx.request.params = params;

    if (_composed.LbuStructure === undefined) {
      const currentHandler = lbuHandlers.structure;
      _composed.LbuStructure = filterCompose(
        tagMiddleware._lbu,

        groupMiddleware.lbu,
        ...(Array.isArray(currentHandler) ? currentHandler : [currentHandler])
      );
    }

    return _composed.LbuStructure(ctx, next);
  },
};

export const todoHandlers = {
  /**
     * 
     * Tags: 
     * GET todo/
     * @param {object} ctx
     * @param { TodoAllResponse } ctx.body 
     
     * @param {Function} next
     * @returns {void|Promise<void>}
     */
  all: (ctx, next) => {
    throw AppError.notImplemented();
  },

  /**
     * 
     * Tags: 
     * GET todo/:name
     * @param {object} ctx
     * @param { TodoListResponse } ctx.body 
     * @param { TodoNameParam } ctx.validatedParams 
     
     * @param {Function} next
     * @returns {void|Promise<void>}
     */
  one: (ctx, next) => {
    throw AppError.notImplemented();
  },

  /**
   *
   * Tags:
   * POST todo/
   * @param {object} ctx
   * @param { TodoListResponse } ctx.body
   * @param { TodoNewBody } ctx.validatedBody
   * @param {Function} next
   * @returns {void|Promise<void>}
   */
  new: (ctx, next) => {
    throw AppError.notImplemented();
  },

  /**
   *
   * Tags:
   * POST todo/:name/item/
   * @param {object} ctx
   * @param { TodoListResponse } ctx.body
   * @param { TodoNameParam } ctx.validatedParams
   * @param { TodoCreateItemBody } ctx.validatedBody
   * @param {Function} next
   * @returns {void|Promise<void>}
   */
  createItem: (ctx, next) => {
    throw AppError.notImplemented();
  },

  /**
   *
   * Tags:
   * POST todo/:name/item/toggle
   * @param {object} ctx
   * @param { TodoListResponse } ctx.body
   * @param { TodoNameParam } ctx.validatedParams
   * @param { TodoToggleItemBody } ctx.validatedBody
   * @param {Function} next
   * @returns {void|Promise<void>}
   */
  toggleItem: (ctx, next) => {
    throw AppError.notImplemented();
  },

  /**
     * 
     * Tags: 
     * DELETE todo/:name
     * @param {object} ctx
     * @param { TodoDeleteResponse } ctx.body 
     * @param { TodoNameParam } ctx.validatedParams 
     
     * @param {Function} next
     * @returns {void|Promise<void>}
     */
  delete: (ctx, next) => {
    throw AppError.notImplemented();
  },
};

export const unimplementedHandlers = {
  /**
     * 
     * Tags: 
     * GET unimplemented/user
     * @param {object} ctx
     * @param { UnimplementedUser } ctx.body 
     
     * @param {Function} next
     * @returns {void|Promise<void>}
     */
  getUser: (ctx, next) => {
    throw AppError.notImplemented();
  },

  /**
     * 
     * Tags: 
     * GET unimplemented/settings
     * @param {object} ctx
     * @param { UnimplementedSettingsResponse } ctx.body 
     
     * @param {Function} next
     * @returns {void|Promise<void>}
     */
  settings: (ctx, next) => {
    throw AppError.notImplemented();
  },
};

export const lbuHandlers = {
  /**
     * Return the full generated structure as a json object.
     * Tags: _lbu
     * GET _lbu/structure.json
     * @param {object} ctx
     
     
     * @param {Function} next
     * @returns {void|Promise<void>}
     */
  structure: (ctx, next) => {
    throw AppError.notImplemented();
  },
};

export function router(ctx, next) {
  let triePath = ctx.method + ctx.path;
  if (triePath.endsWith("/")) {
    triePath = triePath.substring(0, triePath.length - 1);
  }

  const params = Object.create(null);
  let route = undefined;

  route = routeMatcher0(triePath, params, 0);

  if (route !== undefined) {
    return route(params, ctx, next);
  }

  route = routeMatcher1(triePath, params, 0);

  if (route !== undefined) {
    return route(params, ctx, next);
  }

  route = routeMatcher2(triePath, params, 0);

  if (route !== undefined) {
    return route(params, ctx, next);
  }

  route = routeMatcher3(triePath, params, 0);

  if (route !== undefined) {
    return route(params, ctx, next);
  }

  route = routeMatcher5(triePath, params, 0);

  if (route !== undefined) {
    return route(params, ctx, next);
  }

  route = routeMatcher9(triePath, params, 0);

  if (route !== undefined) {
    return route(params, ctx, next);
  }

  return next();
}

lbuHandlers.structure = (ctx, next) => {
  ctx.set("Content-Type", "application/json");
  ctx.body =
    '{"validators":["TodoList","TodoCollection","TodoAllResponse","TodoNameParam","TodoListResponse","TodoNewBody","TodoCreateItemBody","TodoToggleItemBody","TodoDeleteResponse","UnimplementedUser","UnimplementedSettingsResponse"],"models":{"TodoList":{"type":"object","group":"todo","name":"List","uniqueName":"TodoList","docString":"","isOptional":false,"validator":{"strict":false},"keys":{"name":{"type":"string","docString":"","isOptional":false,"validator":{"convert":false,"trim":false,"lowerCase":false,"upperCase":false}},"items":{"type":"array","docString":"","isOptional":false,"validator":{"convert":false},"values":{"type":"reference","docString":"","isOptional":false,"reference":{"group":"todo","name":"Item","uniqueName":"TodoItem"},"validator":{}}}}},"TodoCollection":{"type":"generic","group":"todo","name":"Collection","uniqueName":"TodoCollection","docString":"","isOptional":false,"keys":{"type":"string","docString":"","isOptional":false,"validator":{"convert":false,"trim":false,"lowerCase":false,"upperCase":false}},"values":{"type":"reference","docString":"","isOptional":false,"reference":{"group":"todo","name":"List","uniqueName":"TodoList"},"validator":{}},"validator":{}},"TodoAll":{"type":"route","group":"todo","name":"all","uniqueName":"TodoAll","docString":"","isOptional":false,"method":"GET","path":"todo/","tags":[],"response":{"type":"reference","docString":"","isOptional":false,"reference":{"group":"todo","name":"allResponse","uniqueName":"TodoAllResponse"}}},"TodoOne":{"type":"route","group":"todo","name":"one","uniqueName":"TodoOne","docString":"","isOptional":false,"method":"GET","path":"todo/:name","tags":[],"params":{"type":"reference","docString":"","isOptional":false,"reference":{"group":"todo","name":"NameParam","uniqueName":"TodoNameParam"}},"response":{"type":"reference","docString":"","isOptional":false,"reference":{"group":"todo","name":"ListResponse","uniqueName":"TodoListResponse"}}},"TodoNew":{"type":"route","group":"todo","name":"new","uniqueName":"TodoNew","docString":"","isOptional":false,"method":"POST","path":"todo/","tags":[],"body":{"type":"reference","docString":"","isOptional":false,"reference":{"group":"todo","name":"newBody","uniqueName":"TodoNewBody"}},"response":{"type":"reference","docString":"","isOptional":false,"reference":{"group":"todo","name":"ListResponse","uniqueName":"TodoListResponse"}}},"TodoCreateItem":{"type":"route","group":"todo","name":"createItem","uniqueName":"TodoCreateItem","docString":"","isOptional":false,"method":"POST","path":"todo/:name/item/","tags":[],"params":{"type":"reference","docString":"","isOptional":false,"reference":{"group":"todo","name":"NameParam","uniqueName":"TodoNameParam"}},"body":{"type":"reference","docString":"","isOptional":false,"reference":{"group":"todo","name":"createItemBody","uniqueName":"TodoCreateItemBody"}},"response":{"type":"reference","docString":"","isOptional":false,"reference":{"group":"todo","name":"ListResponse","uniqueName":"TodoListResponse"}}},"TodoToggleItem":{"type":"route","group":"todo","name":"toggleItem","uniqueName":"TodoToggleItem","docString":"","isOptional":false,"method":"POST","path":"todo/:name/item/toggle","tags":[],"params":{"type":"reference","docString":"","isOptional":false,"reference":{"group":"todo","name":"NameParam","uniqueName":"TodoNameParam"}},"body":{"type":"reference","docString":"","isOptional":false,"reference":{"group":"todo","name":"toggleItemBody","uniqueName":"TodoToggleItemBody"}},"response":{"type":"reference","docString":"","isOptional":false,"reference":{"group":"todo","name":"ListResponse","uniqueName":"TodoListResponse"}}},"TodoDelete":{"type":"route","group":"todo","name":"delete","uniqueName":"TodoDelete","docString":"","isOptional":false,"method":"DELETE","path":"todo/:name","tags":[],"params":{"type":"reference","docString":"","isOptional":false,"reference":{"group":"todo","name":"NameParam","uniqueName":"TodoNameParam"}},"response":{"type":"reference","docString":"","isOptional":false,"reference":{"group":"todo","name":"deleteResponse","uniqueName":"TodoDeleteResponse"}}},"UnimplementedGetUser":{"type":"route","group":"unimplemented","name":"getUser","uniqueName":"UnimplementedGetUser","docString":"","isOptional":false,"method":"GET","path":"unimplemented/user","tags":[],"response":{"type":"reference","docString":"","isOptional":false,"reference":{"group":"unimplemented","name":"User","uniqueName":"UnimplementedUser"}}},"UnimplementedSettings":{"type":"route","group":"unimplemented","name":"settings","uniqueName":"UnimplementedSettings","docString":"","isOptional":false,"method":"GET","path":"unimplemented/settings","tags":[],"response":{"type":"reference","docString":"","isOptional":false,"reference":{"group":"unimplemented","name":"settingsResponse","uniqueName":"UnimplementedSettingsResponse"}}},"LbuStructure":{"type":"route","group":"lbu","name":"structure","uniqueName":"LbuStructure","docString":"Return the full generated structure as a json object.","isOptional":false,"method":"GET","path":"_lbu/structure.json","tags":["_lbu"]},"TodoAllResponse":{"type":"object","group":"todo","name":"allResponse","uniqueName":"TodoAllResponse","docString":"","isOptional":false,"validator":{"strict":false},"keys":{"store":{"type":"reference","docString":"","isOptional":false,"reference":{"group":"todo","name":"Collection","uniqueName":"TodoCollection"},"validator":{}}}},"TodoNameParam":{"type":"object","group":"todo","name":"NameParam","uniqueName":"TodoNameParam","docString":"","isOptional":false,"validator":{"strict":false},"keys":{"name":{"type":"string","docString":"","isOptional":false,"validator":{"convert":true,"trim":true,"lowerCase":false,"upperCase":false,"min":0,"max":30}}}},"TodoListResponse":{"type":"object","group":"todo","name":"ListResponse","uniqueName":"TodoListResponse","docString":"","isOptional":false,"validator":{"strict":false},"keys":{"todo":{"type":"reference","docString":"","isOptional":false,"reference":{"group":"todo","name":"List","uniqueName":"TodoList"},"validator":{}}}},"TodoNewBody":{"type":"object","group":"todo","name":"newBody","uniqueName":"TodoNewBody","docString":"","isOptional":false,"validator":{"strict":false},"keys":{"name":{"type":"string","docString":"","isOptional":false,"validator":{"convert":false,"trim":true,"lowerCase":false,"upperCase":false,"min":1,"max":40},"mocks":"\'Todo \' + _mocker.integer({ min: 0, max: 1000 })"}}},"TodoCreateItemBody":{"type":"object","group":"todo","name":"createItemBody","uniqueName":"TodoCreateItemBody","docString":"","isOptional":false,"validator":{"strict":false},"keys":{"name":{"type":"string","docString":"","isOptional":false,"validator":{"convert":false,"trim":true,"lowerCase":false,"upperCase":false,"min":1,"max":365},"mocks":"_mocker.sentence({ words: 6 })"}}},"TodoToggleItemBody":{"type":"object","group":"todo","name":"toggleItemBody","uniqueName":"TodoToggleItemBody","docString":"","isOptional":false,"validator":{"strict":false},"keys":{"index":{"type":"number","docString":"","isOptional":false,"validator":{"convert":true,"integer":true,"min":0}}}},"TodoDeleteResponse":{"type":"object","group":"todo","name":"deleteResponse","uniqueName":"TodoDeleteResponse","docString":"","isOptional":false,"validator":{"strict":false},"keys":{"deleted":{"type":"boolean","docString":"","isOptional":false,"validator":{"convert":false}}}},"UnimplementedUser":{"type":"object","group":"unimplemented","name":"User","uniqueName":"UnimplementedUser","docString":"","isOptional":false,"validator":{"strict":false},"keys":{"id":{"type":"uuid","docString":"","isOptional":false,"validator":{}},"name":{"type":"string","docString":"","isOptional":false,"validator":{"convert":false,"trim":false,"lowerCase":false,"upperCase":false},"mocks":"_mocker.first() + \' \' + _mocker.last()"},"age":{"type":"number","docString":"","isOptional":false,"validator":{"convert":false,"integer":true},"mocks":"_mocker.age()"}}},"UnimplementedSettingsResponse":{"type":"object","group":"unimplemented","name":"settingsResponse","uniqueName":"UnimplementedSettingsResponse","docString":"","isOptional":false,"validator":{"strict":false},"keys":{"darkMode":{"type":"boolean","docString":"","isOptional":true,"defaultValue":true,"validator":{"convert":false}},"preferredNumber":{"type":"number","docString":"","isOptional":false,"validator":{"convert":true,"integer":true,"min":0,"max":10}},"direction":{"type":"reference","docString":"","isOptional":false,"reference":{"group":"unimplemented","name":"WindDirection","uniqueName":"UnimplementedWindDirection"},"validator":{}},"totalMess":{"type":"array","docString":"","isOptional":false,"validator":{"convert":false},"values":{"type":"anyOf","docString":"","isOptional":false,"values":[{"type":"number","docString":"","isOptional":true,"validator":{"convert":false,"integer":false,"min":1,"max":150}},{"type":"string","docString":"","isOptional":true,"defaultValue":"new Date().toISOString()","validator":{"convert":false,"trim":false,"lowerCase":false,"upperCase":false},"mocks":"new Date(_mocker.timestamp() * 1000).toISOString()"},{"type":"array","docString":"","isOptional":false,"validator":{"convert":false},"values":{"type":"boolean","docString":"","isOptional":true,"defaultValue":false,"validator":{"convert":true}}},{"type":"object","docString":"","isOptional":false,"validator":{"strict":false},"keys":{"foo":{"type":"boolean","docString":"","isOptional":true,"validator":{"convert":false}}}}],"validator":{}}}}},"TodoItem":{"type":"object","group":"todo","name":"Item","uniqueName":"TodoItem","docString":"","isOptional":false,"validator":{"strict":false},"keys":{"completed":{"type":"boolean","docString":"","isOptional":true,"defaultValue":false,"validator":{"convert":false}},"name":{"type":"string","docString":"","isOptional":false,"validator":{"convert":false,"trim":false,"lowerCase":false,"upperCase":false}}}},"UnimplementedWindDirection":{"type":"string","group":"unimplemented","name":"WindDirection","uniqueName":"UnimplementedWindDirection","docString":"","isOptional":true,"defaultValue":"\'NORTH\'","oneOf":["NORTH","EAST","SOUTH","WEST"],"validator":{"convert":false,"trim":false,"lowerCase":false,"upperCase":false}}},"groups":["todo","unimplemented","lbu"],"routeTags":["_lbu"],"routes":["TodoAll","TodoOne","TodoNew","TodoCreateItem","TodoToggleItem","TodoDelete","UnimplementedGetUser","UnimplementedSettings","LbuStructure"]}';

  return next();
};

function routeMatcher0(path, params, currentIdx) {
  if (!path.startsWith("GET/unimplemented/settings", currentIdx)) {
    return undefined;
  }

  return handlers.UnimplementedSettings;
}
function routeMatcher1(path, params, currentIdx) {
  if (!path.startsWith("GET/_lbu/structure.json", currentIdx)) {
    return undefined;
  }

  return handlers.LbuStructure;
}
function routeMatcher2(path, params, currentIdx) {
  if (!path.startsWith("GET/unimplemented/user", currentIdx)) {
    return undefined;
  }

  return handlers.UnimplementedGetUser;
}
function routeMatcher4(path, params, currentIdx) {
  let subIdx = path.indexOf("/", currentIdx);
  if (subIdx === -1) {
    subIdx = path.length;
  }

  const subPath = path.substring(currentIdx, subIdx);

  params.name = decodeURIComponent(subPath);
  return handlers.TodoDelete;
}
function routeMatcher3(path, params, currentIdx) {
  if (!path.startsWith("DELETE/todo", currentIdx)) {
    return undefined;
  }

  const nextIdx = currentIdx + 1 + 11;
  let handler = undefined;

  handler = routeMatcher4(path, params, nextIdx);

  if (handler !== undefined) {
    return handler;
  }

  return undefined;
}
function routeMatcher8(path, params, currentIdx) {
  if (!path.startsWith("toggle", currentIdx)) {
    return undefined;
  }

  return handlers.TodoToggleItem;
}
function routeMatcher7(path, params, currentIdx) {
  if (!path.startsWith("item", currentIdx)) {
    return undefined;
  }

  const nextIdx = currentIdx + 1 + 4;
  let handler = undefined;

  if (path.length === nextIdx - 1) {
    return handlers.TodoCreateItem;
  }

  handler = routeMatcher8(path, params, nextIdx);

  if (handler !== undefined) {
    return handler;
  }

  return undefined;
}
function routeMatcher6(path, params, currentIdx) {
  let subIdx = path.indexOf("/", currentIdx);
  if (subIdx === -1) {
    subIdx = path.length;
  }

  const subPath = path.substring(currentIdx, subIdx);

  const nextIdx = subIdx + 1;
  let handler = undefined;

  handler = routeMatcher7(path, params, nextIdx);

  if (handler !== undefined) {
    params.name = decodeURIComponent(subPath);
    return handler;
  }

  return undefined;
}
function routeMatcher5(path, params, currentIdx) {
  if (!path.startsWith("POST/todo", currentIdx)) {
    return undefined;
  }

  const nextIdx = currentIdx + 1 + 9;
  let handler = undefined;

  if (path.length === nextIdx - 1) {
    return handlers.TodoNew;
  }

  handler = routeMatcher6(path, params, nextIdx);

  if (handler !== undefined) {
    return handler;
  }

  return undefined;
}
function routeMatcher10(path, params, currentIdx) {
  let subIdx = path.indexOf("/", currentIdx);
  if (subIdx === -1) {
    subIdx = path.length;
  }

  const subPath = path.substring(currentIdx, subIdx);

  params.name = decodeURIComponent(subPath);
  return handlers.TodoOne;
}
function routeMatcher9(path, params, currentIdx) {
  if (!path.startsWith("GET/todo", currentIdx)) {
    return undefined;
  }

  const nextIdx = currentIdx + 1 + 8;
  let handler = undefined;

  if (path.length === nextIdx - 1) {
    return handlers.TodoAll;
  }

  handler = routeMatcher10(path, params, nextIdx);

  if (handler !== undefined) {
    return handler;
  }

  return undefined;
}
